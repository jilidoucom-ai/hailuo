"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[15],{12321(e,t,n){n.d(t,{A:()=>r});var a=n(20641),s=n(90033),l={key:0,class:"spinner-text"};const i={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const r=(0,n(66262).A)(i,[["render",function(e,t,n,i,r,u){return(0,a.uX)(),(0,a.CE)("div",{class:(0,s.normalizeClass)(["loading-spinner",{"loading-spinner-overlay":n.overlay}])},[t[0]||(t[0]=(0,a.Lk)("div",{class:"spinner"},[(0,a.Lk)("div",{class:"spinner-circle"})],-1)),n.text?((0,a.uX)(),(0,a.CE)("div",l,(0,s.toDisplayString)(n.text),1)):(0,a.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},46510(e,t,n){n.d(t,{F$:()=>s,Hi:()=>u,RV:()=>r,Z2:()=>l,yN:()=>i});var a=n(19043);function s(){return(0,a.A)({url:"/user/ticket/fetch",method:"get"})}function l(e){return(0,a.A)({url:"/user/ticket/save",method:"post",data:e})}function i(e){return(0,a.A)({url:"/user/ticket/fetch?id=".concat(e),method:"get"})}function r(e,t){return(0,a.A)({url:"/user/ticket/reply",method:"post",data:{id:e,message:t}})}function u(e){return(0,a.A)({url:"/user/ticket/close",method:"post",data:{id:e}})}},60015(e,t,n){n.r(t),n.d(t,{default:()=>ze});var a=n(90208),s=n(78676),l=n(20908),i=n(41034),r=n(30388),u=(n(16280),n(76918),n(28706),n(2008),n(23418),n(74423),n(64346),n(62062),n(44114),n(34782),n(59089),n(23288),n(18111),n(22489),n(61701),n(2892),n(26099),n(58940),n(99449),n(21699),n(47764),n(11392),n(42762),n(62953),n(76031),n(20641)),c=n(50953),o=n(90033),d=n(53751),v=n(46992),p=n(71029),k=n(25506),f=n(14860),m=n(12321),g=n(33366),y=n(46510),b=n(92549),h=n(49586),L=n(80394),C=n(69668),w={class:"mobile-ticket-container"},S={key:0,class:"screen-size-notice"},A={class:"notice-content"},D={class:"dashboard-card welcome-card"},R={class:"card-header"},E={class:"card-title"},T={class:"card-body"},X={key:0,class:"ticket-list"},K={class:"create-ticket-wrapper"},I={key:0,class:"loading-state"},$={key:1,class:"tickets-content"},_=["onClick"],F={class:"ticket-header"},x={class:"ticket-subject"},M={class:"ticket-info"},z={class:"ticket-time"},W={class:"ticket-id"},j={key:2,class:"empty-state"},N={key:1,class:"ticket-detail"},H={class:"detail-header"},P={class:"ticket-info"},G={class:"meta-info"},O={class:"messages-container"},Q={key:0,class:"loading-state"},B={key:1,class:"empty-messages"},V={key:2,class:"message-list"},U={class:"message-avatar"},Y={class:"message-content"},q={class:"message-header"},Z={class:"sender-name"},J={class:"message-time"},ee=["innerHTML"],te={key:0,class:"reply-box"},ne=["placeholder","onKeydown"],ae={class:"reply-tools",style:{display:"flex",gap:"8px","align-items":"center","justify-content":"flex-end"}},se=["disabled"],le={key:1,class:"loader"},ie={key:2},re={key:3},ue=["disabled"],ce={key:0,class:"loader"},oe={key:1,class:"ticket-closed-notice"},de={class:"modal-header"},ve={class:"modal-body"},pe={class:"form-group"},ke=["placeholder"],fe={class:"form-group"},me={class:"priority-selector"},ge=["onClick"],ye={class:"form-group"},be=["placeholder"],he={class:"upload-tip"},Le={class:"upload-tip-text"},Ce={class:"upload-desc"},we={key:1,style:{"margin-top":"8px",color:"#2196f3"}},Se={key:2,style:{"margin-top":"8px"}},Ae=["onClick"],De=["src"],Re={class:"modal-footer"},Ee=["disabled"],Te={key:0,class:"loader"},Xe={class:"modal-header"},Ke={class:"modal-body"},Ie={class:"modal-footer"},$e=["disabled"],_e={key:0},Fe={key:1,class:"btn-loading"},xe="https://api.imgbb.com/1/upload";const Me={__name:"MobileTicketList",setup:function(e){var t=new k.A({linkify:!0,breaks:!0}),n=(0,v.s9)().t,Me=(0,g.d)().showToast,ze=(0,p.rd)(),We=(0,c.KR)(!1),je=(0,c.KR)([]),Ne=(0,c.KR)(!1),He=(0,c.KR)(!1),Pe=(0,c.KR)(null),Ge=(0,c.KR)([]),Oe=(0,c.KR)(!1),Qe=(0,c.KR)(""),Be=(0,c.KR)(!1),Ve=(0,c.KR)(!1),Ue=(0,c.KR)(!1),Ye=(0,c.KR)(null),qe=(0,c.KR)({subject:"",message:"",level:0}),Ze=(0,c.KR)(!1),Je=(0,c.KR)(!1),et=(null===L.TICKET_CONFIG||void 0===L.TICKET_CONFIG?void 0:L.TICKET_CONFIG.popup)||{},tt=function(){Ze.value=window.innerWidth>=905},nt=function(){ze.push("/tickets")};(0,u.sV)(function(){tt(),window.addEventListener("resize",tt),vt(),yt()}),(0,u.hi)(function(){window.removeEventListener("resize",tt),ut()});var at=function(e){var t={0:n("tickets.levelLow"),1:n("tickets.levelMedium"),2:n("tickets.levelHigh")};return t[e]||t[0]},st=function(e){if(!e)return"--";var t=new Date(1e3*e),n=new Date;return t.getDate()===n.getDate()&&t.getMonth()===n.getMonth()&&t.getFullYear()===n.getFullYear()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{month:"short",day:"numeric"})+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},lt=function(){Ne.value=!0},it=function(){var e=document.querySelector(".modal-content");e?(e.classList.add("closing"),setTimeout(function(){Ne.value=!1,qe.value={subject:"",message:"",level:0}},300)):(Ne.value=!1,qe.value={subject:"",message:"",level:0})},rt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var a,s,r,u,c=arguments;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return(a=c.length>1&&void 0!==c[1]&&c[1])||(Oe.value=!0,Ge.value=[]),e.p=1,e.n=2,(0,y.yN)(t);case 2:(s=e.v).data&&(s.data.message&&Array.isArray(s.data.message)?Ge.value=s.data.message.map(function(e){return(0,i.A)((0,i.A)({},e),{},{is_admin:!e.is_me})}):Ge.value=[],Pe.value&&Pe.value.id===t&&void 0!==s.data.status&&(Pe.value.status=s.data.status,1===s.data.status&&ut())),e.n=4;break;case 3:e.p=3,u=e.v,Me((null===(r=u.response)||void 0===r?void 0:r.message)||u.message||n("tickets.fetchDetailError"),"error");case 4:return e.p=4,a||(Oe.value=!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),ut=function(){Ye.value&&(clearInterval(Ye.value),Ye.value=null)},ct=function(e){ut(),Pe.value&&0===Pe.value.status&&(Ye.value=setInterval(function(){Pe.value&&Pe.value.id===e?rt(e,!0):ut()},5e3))},ot=function(){var e=(0,r.A)((0,l.A)().m(function e(t){return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:return ut(),Pe.value=t,e.n=1,rt(t.id);case 1:0===t.status&&ct(t.id);case 2:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),dt=function(){ut();var e=document.querySelector(".ticket-detail");e?(e.classList.add("closing"),setTimeout(function(){Pe.value=null},280)):Pe.value=null},vt=function(){var e=(0,r.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return We.value=!0,e.p=1,e.n=2,(0,y.F$)();case 2:t=e.v,je.value=Array.isArray(t.data)?t.data:[],e.n=4;break;case 3:e.p=3,s=e.v,Me((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.fetchError"),"error");case 4:return e.p=4,We.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=(0,r.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Qe.value.trim()&&Pe.value&&!Be.value){e.n=1;break}return e.a(2);case 1:return Be.value=!0,e.p=2,e.n=3,(0,y.RV)(Pe.value.id,Qe.value);case 3:if(!(t=e.v).data){e.n=4;break}return Me(t.message||n("tickets.replySent"),"success"),Qe.value="",e.n=4,rt(Pe.value.id,!0);case 4:e.n=6;break;case 5:e.p=5,s=e.v,Me((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.replyError"),"error");case 6:return e.p=6,Be.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),kt=function(){Ve.value=!0},ft=function(){var e=document.querySelector(".modal-content");e?(e.classList.add("closing"),setTimeout(function(){Ve.value=!1,Ue.value=!1},300)):(Ve.value=!1,Ue.value=!1)},mt=function(){var e=(0,r.A)((0,l.A)().m(function e(){var t,a,s;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Pe.value){e.n=1;break}return e.a(2);case 1:return Ue.value=!0,e.p=2,e.n=3,(0,y.Hi)(Pe.value.id);case 3:if(!0!==(t=e.v).data){e.n=5;break}return Me(t.message||n("tickets.closeSuccess"),"success"),Ve.value=!1,Pe.value.status=1,e.n=4,vt();case 4:ut(),dt();case 5:e.n=7;break;case 6:e.p=6,s=e.v,Me((null===(a=s.response)||void 0===a?void 0:a.message)||s.message||n("tickets.closeError"),"error");case 7:return e.p=7,Ue.value=!1,e.f(7);case 8:return e.a(2)}},e,null,[[2,6,7,8]])}));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=(0,r.A)((0,l.A)().m(function e(){var t,a,i,r,u,c,o,d,v,p,k;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(qe.value.subject&&qe.value.message){e.n=1;break}return Me(n("tickets.formIncomplete"),"error"),e.a(2);case 1:if(He.value=!0,e.p=2,t=qe.value.message,!L.TICKET_CONFIG.includeUserInfoInTicket){e.n=4;break}return e.n=3,Promise.all([(0,b.ug)(),(0,b.l8)(),(0,b._8)(),(0,b.XL)()]);case 3:a=e.v,i=(0,s.A)(a,4),r=i[0],u=i[1],c=i[2],o=i[3],u&&u.data&&u.data.currency_symbol&&(r.currency_symbol=u.data.currency_symbol),d=(0,h.AB)(r,o,c),t="".concat(qe.value.message,"\n\n").concat(d);case 4:return e.n=5,(0,y.Z2)({subject:qe.value.subject,message:t,level:parseInt(qe.value.level)});case 5:if(!(v=e.v).data){e.n=7;break}return Me(v.message||n("tickets.createSuccess"),"success"),it(),e.n=6,vt();case 6:qe.value={subject:"",message:"",level:"0"};case 7:e.n=9;break;case 8:e.p=8,k=e.v,Me((null===(p=k.response)||void 0===p?void 0:p.message)||k.message||n("tickets.createError"),"error");case 9:return e.p=9,He.value=!1,e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(){return e.apply(this,arguments)}}(),yt=function(){if(et.enabled){var e=Number(localStorage.getItem("ticket_popup_close_time")||0),t=3600*(et.cooldownHours||0)*1e3;(!e||Date.now()-e>=t)&&(Je.value=!0)}},bt=function(){Je.value=!1};vt();var ht=(0,c.KR)([]),Lt=(0,c.KR)(!1),Ct=(0,c.KR)(!1),wt=(0,c.KR)(null),St=(0,c.KR)(null),At=(0,c.KR)(0),Dt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var n,a,s,i,r,c,o,d;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(i=St.value,r=qe.value.message||"",i){e.n=1;break}return qe.value.message=r+(r&&!r.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(n=null!==(a=i.selectionStart)&&void 0!==a?a:At.value)&&void 0!==n?n:r.length,o=null!==(s=i.selectionEnd)&&void 0!==s?s:c,qe.value.message=r.slice(0,c)+t+r.slice(o),e.n=2,(0,u.dY)();case 2:d=c+t.length,i.focus(),i.setSelectionRange(d,d),At.value=d;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Rt=L.TICKET_CONFIG.imgbbApiKey,Et=function(){wt.value&&wt.value.click()},Tt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var n;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(Ct.value=!1,!(n=Array.from(t.dataTransfer.files).filter(function(e){return e.type.startsWith("image/")})).length){e.n=1;break}return e.n=1,Xt({target:{files:n}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Xt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var n,s,i,r;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if((n=Array.from(t.target.files)).length){e.n=1;break}return e.a(2);case 1:Lt.value=!0,s=(0,l.A)().m(function e(){var t,n,a,s,u,c;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!((t=r[i]).size>5242880)){e.n=1;break}return Me("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(2,1);case 1:return e.p=1,e.n=2,new Promise(function(e,n){var a=new FileReader;a.onload=function(){return e(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(t)});case 2:return n=e.v,(a=new FormData).append("image",n),e.n=3,fetch("".concat(xe,"?key=").concat(Rt),{method:"POST",body:a});case 3:return s=e.v,e.n=4,s.json();case 4:(u=e.v).success&&u.data&&u.data.url?(ht.value.push(u.data.url),qe.value.message+="\n![image](".concat(u.data.url,")")):Me((null===(c=u.error)||void 0===c?void 0:c.message)||"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25","error"),e.n=6;break;case 5:e.p=5,e.v,Me("\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 6:return e.a(2)}},e,null,[[1,5]])}),i=0,r=n;case 2:if(!(i<r.length)){e.n=5;break}return e.d((0,a.A)(s()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,4);case 4:i++,e.n=2;break;case 5:Lt.value=!1;case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),Kt=(0,c.KR)(null),It=(0,c.KR)(null),$t=(0,c.KR)(!1),_t=(0,c.KR)(0),Ft=function(){Kt.value&&Kt.value.click()},xt=function(){var e,t=It.value;t&&(_t.value=null!==(e=t.selectionStart)&&void 0!==e?e:Qe.value.length)},Mt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var n,a,s,i,r,c,o,d;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:if(i=It.value,r=Qe.value||"",i){e.n=1;break}return Qe.value=r+(r&&!r.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return c=null!==(n=null!==(a=i.selectionStart)&&void 0!==a?a:_t.value)&&void 0!==n?n:r.length,o=null!==(s=i.selectionEnd)&&void 0!==s?s:c,Qe.value=r.slice(0,c)+t+r.slice(o),e.n=2,(0,u.dY)();case 2:d=c+t.length,i.focus(),i.setSelectionRange(d,d),_t.value=d;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),zt=function(e){return new Promise(function(t,n){var a=new FileReader;a.onload=function(){return t(a.result.split(",")[1])},a.onerror=n,a.readAsDataURL(e)})},Wt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var n,a,s,i,r,u;return(0,l.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,zt(t);case 1:return s=e.v,(i=new FormData).append("image",s),e.n=2,fetch("".concat(xe,"?key=").concat(Rt),{method:"POST",body:i});case 2:return r=e.v,e.n=3,r.json();case 3:if(!(u=e.v).success||null===(n=u.data)||void 0===n||!n.url){e.n=4;break}return e.a(2,u.data.url);case 4:throw new Error((null===(a=u.error)||void 0===a?void 0:a.message)||"imgbb \u4e0a\u4f20\u5931\u8d25");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=(0,r.A)((0,l.A)().m(function e(t){var a,s,i,r,u,c,o;return(0,l.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if((a=Array.from(t.target.files||[])).length){e.n=1;break}return e.a(2);case 1:$t.value=!0,e.p=2,s=0,i=a;case 3:if(!(s<i.length)){e.n=7;break}if(!((r=i[s]).size>5242880)){e.n=4;break}return Me("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(3,6);case 4:return e.n=5,Wt(r);case 5:return u=e.v,c="![image](".concat(u,")"),e.n=6,Mt(c);case 6:s++,e.n=3;break;case 7:Me(n("tickets.uploadSuccess")||"\u56fe\u7247\u4e0a\u4f20\u6210\u529f","success"),e.n=9;break;case 8:e.p=8,o=e.v,Me(o.message||"\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 9:return e.p=9,$t.value=!1,Kt.value&&(Kt.value.value=""),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}();return function(e,n){return(0,u.uX)(),(0,u.CE)("div",w,[Ze.value?((0,u.uX)(),(0,u.CE)("div",S,[(0,u.Lk)("div",A,[(0,u.bF)((0,c.R1)(f.vk8),{size:48}),(0,u.Lk)("h2",null,(0,o.toDisplayString)(e.$t("tickets.largeScreenNotice")),1),(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.switchToDesktop")),1),(0,u.Lk)("button",{class:"switch-btn",onClick:nt},(0,o.toDisplayString)(e.$t("tickets.switchToDesktopView")),1)])])):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.Lk)("div",D,[(0,u.Lk)("div",R,[(0,u.Lk)("h2",E,(0,o.toDisplayString)(e.$t("tickets.title")),1)]),(0,u.Lk)("div",T,[(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.description")),1)])]),Pe.value?((0,u.uX)(),(0,u.CE)("div",N,[(0,u.Lk)("div",H,[(0,u.Lk)("button",{class:"back-btn",onClick:dt},[(0,u.bF)((0,c.R1)(f.Gk),{size:20})]),(0,u.Lk)("div",P,[(0,u.Lk)("h2",null,(0,o.toDisplayString)(Pe.value.subject),1),(0,u.Lk)("div",G,[(0,u.Lk)("span",{class:(0,o.normalizeClass)(["status-badge","status-".concat(Pe.value.status)])},(0,o.toDisplayString)(0===Pe.value.status?e.$t("tickets.statusOpen"):e.$t("tickets.statusClosed")),3),(0,u.Lk)("span",{class:(0,o.normalizeClass)(["level-badge","level-".concat(Pe.value.level)])},(0,o.toDisplayString)(at(Pe.value.level)),3)])]),0===Pe.value.status?((0,u.uX)(),(0,u.CE)("button",{key:0,class:"close-ticket-btn",onClick:kt},[(0,u.bF)((0,c.R1)(f.MRt),{size:16})])):(0,u.Q3)("",!0)]),(0,u.Lk)("div",O,[Oe.value?((0,u.uX)(),(0,u.CE)("div",Q,[(0,u.bF)(m.A),(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.loadingMessages")),1)])):0===Ge.value.length?((0,u.uX)(),(0,u.CE)("div",B,[(0,u.bF)((0,c.R1)(f.bYO),{size:48}),(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.noMessages")),1)])):((0,u.uX)(),(0,u.CE)("div",V,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(Ge.value,function(n){return(0,u.uX)(),(0,u.CE)("div",{key:n.id,class:(0,o.normalizeClass)(["message-item",n.is_admin?"admin-message":"user-message"])},[(0,u.Lk)("div",U,[n.is_admin?((0,u.uX)(),(0,u.Wv)((0,c.R1)(f.ut_),{key:0})):((0,u.uX)(),(0,u.Wv)((0,c.R1)(f.vg7),{key:1}))]),(0,u.Lk)("div",Y,[(0,u.Lk)("div",q,[(0,u.Lk)("span",Z,(0,o.toDisplayString)(n.is_admin?e.$t("tickets.admin"):e.$t("tickets.you")),1),(0,u.Lk)("span",J,(0,o.toDisplayString)(st(n.created_at)),1)]),(0,u.Lk)("div",{class:"message-text",innerHTML:(0,c.R1)(t).render(n.message)},null,8,ee)])],2)}),128))]))]),0===Pe.value.status?((0,u.uX)(),(0,u.CE)("div",te,[(0,u.bo)((0,u.Lk)("textarea",{"onUpdate:modelValue":n[0]||(n[0]=function(e){return Qe.value=e}),placeholder:e.$t("tickets.replyPlaceholder"),rows:"3",onKeydown:(0,d.withKeys)((0,d.withModifiers)(pt,["ctrl"]),["enter"]),onKeyup:xt,onClick:xt},null,40,ne),[[d.vModelText,Qe.value]]),(0,u.Lk)("div",ae,[(0,u.Lk)("button",{class:"send-btn",type:"button",onClick:Ft,disabled:$t.value},[$t.value?((0,u.uX)(),(0,u.CE)("span",le)):((0,u.uX)(),(0,u.Wv)((0,c.R1)(f.GYm),{key:0,size:18})),$t.value?((0,u.uX)(),(0,u.CE)("span",re,(0,o.toDisplayString)(e.$t("tickets.uploadingImages")||"\u4e0a\u4f20\u4e2d"),1)):((0,u.uX)(),(0,u.CE)("span",ie,(0,o.toDisplayString)(e.$t("tickets.upPictures")||"\u4e0a\u4f20\u56fe\u7247"),1))],8,se),(0,u.Lk)("button",{class:"send-btn",onClick:pt,disabled:!Qe.value.trim()||Be.value},[Be.value?((0,u.uX)(),(0,u.CE)("span",ce)):((0,u.uX)(),(0,u.Wv)((0,c.R1)(f.mDt),{key:1,size:18})),(0,u.eW)(" "+(0,o.toDisplayString)(e.$t("tickets.send")),1)],8,ue)]),(0,u.Lk)("input",{ref_key:"replyImageInput",ref:Kt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:jt},null,544)])):((0,u.uX)(),(0,u.CE)("div",oe,[(0,u.bF)((0,c.R1)(f.XEb),{size:20}),(0,u.Lk)("span",null,(0,o.toDisplayString)(e.$t("tickets.ticketClosed")),1)]))])):((0,u.uX)(),(0,u.CE)("div",X,[(0,u.Lk)("div",K,[(0,u.Lk)("button",{class:"new-ticket-btn",onClick:lt},[(0,u.bF)((0,c.R1)(f.uID),{size:18}),(0,u.eW)(" "+(0,o.toDisplayString)(e.$t("tickets.newTicket")),1)])]),We.value?((0,u.uX)(),(0,u.CE)("div",I,[(0,u.bF)(m.A),(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.loadingTickets")),1)])):je.value.length>0?((0,u.uX)(),(0,u.CE)("div",$,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(je.value,function(t){return(0,u.uX)(),(0,u.CE)("div",{key:t.id,class:"ticket-item",onClick:function(e){return ot(t)}},[(0,u.Lk)("div",F,[(0,u.Lk)("span",x,(0,o.toDisplayString)(t.subject),1),(0,u.Lk)("span",{class:(0,o.normalizeClass)(["ticket-status","status-".concat(t.status)])},(0,o.toDisplayString)(0===t.status?e.$t("tickets.statusOpen"):e.$t("tickets.statusClosed")),3)]),(0,u.Lk)("div",M,[(0,u.Lk)("span",z,(0,o.toDisplayString)((n=t.created_at,n?new Date(1e3*n).toLocaleString():"--")),1),(0,u.Lk)("span",W,"#"+(0,o.toDisplayString)(t.id),1)])],8,_);var n}),128))])):((0,u.uX)(),(0,u.CE)("div",j,[(0,u.bF)((0,c.R1)(f.yg_),{size:48}),(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.noTickets")),1),(0,u.Lk)("button",{class:"create-ticket-btn",onClick:lt},(0,o.toDisplayString)(e.$t("tickets.createNew")),1)]))]))],64)),((0,u.uX)(),(0,u.Wv)(u.Im,{to:"body"},[Ne.value?((0,u.uX)(),(0,u.CE)("div",{key:0,class:"modal-overlay",onClick:it},[(0,u.Lk)("div",{class:"modal-content",onClick:n[5]||(n[5]=(0,d.withModifiers)(function(){},["stop"]))},[(0,u.Lk)("div",de,[(0,u.Lk)("h3",null,(0,o.toDisplayString)(e.$t("tickets.createNew")),1),(0,u.Lk)("button",{class:"close-btn",onClick:it},[(0,u.bF)((0,c.R1)(f.MRt),{size:20})])]),(0,u.Lk)("div",ve,[(0,u.Lk)("div",pe,[(0,u.Lk)("label",null,(0,o.toDisplayString)(e.$t("tickets.subject")),1),(0,u.bo)((0,u.Lk)("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=function(e){return qe.value.subject=e}),placeholder:e.$t("tickets.subjectPlaceholder")},null,8,ke),[[d.vModelText,qe.value.subject]])]),(0,u.Lk)("div",fe,[(0,u.Lk)("label",null,(0,o.toDisplayString)(e.$t("tickets.level")),1),(0,u.Lk)("div",me,[((0,u.uX)(),(0,u.CE)(u.FK,null,(0,u.pI)([0,1,2],function(e){return(0,u.Lk)("button",{key:e,class:(0,o.normalizeClass)(["priority-btn",{active:qe.value.level===e}]),onClick:function(t){return qe.value.level=e}},(0,o.toDisplayString)(at(e)),11,ge)}),64))])]),(0,u.Lk)("div",ye,[(0,u.Lk)("label",null,(0,o.toDisplayString)(e.$t("tickets.message")),1),(0,u.bo)((0,u.Lk)("textarea",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return qe.value.message=e}),placeholder:e.$t("tickets.messagePlaceholder"),rows:"5"},null,8,be),[[d.vModelText,qe.value.message]]),(0,c.R1)(L.TICKET_CONFIG).isImageHosting?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,o.normalizeClass)(["image-upload-area",{dragging:Ct.value}]),onDragover:n[3]||(n[3]=(0,d.withModifiers)(function(e){return Ct.value=!0},["prevent"])),onDragleave:n[4]||(n[4]=(0,d.withModifiers)(function(e){return Ct.value=!1},["prevent"])),onDrop:(0,d.withModifiers)(Tt,["prevent"]),onClick:Et},[(0,u.Lk)("div",he,[(0,u.Lk)("span",Le,(0,o.toDisplayString)(e.$t("tickets.uploadTipText")||"\u62d6\u62fd\u56fe\u7247\u5230\u6b64\u5904\u6216\u70b9\u51fb\u4e0a\u4f20"),1),n[7]||(n[7]=(0,u.Lk)("br",null,null,-1)),(0,u.Lk)("span",Ce,(0,o.toDisplayString)(e.$t("tickets.uploadDescText")||"\u652f\u6301 JPG\u3001PNG\u3001GIF \u683c\u5f0f\uff0c\u6700\u5927 5 MB"),1)]),(0,u.Lk)("input",{ref_key:"imageInput",ref:wt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:Xt},null,544)],34)):(0,u.Q3)("",!0),Lt.value?((0,u.uX)(),(0,u.CE)("div",we,(0,o.toDisplayString)(e.$t("tickets.uploadingImages")||"\u56fe\u7247\u4e0a\u4f20\u4e2d..."),1)):(0,u.Q3)("",!0),ht.value.length?((0,u.uX)(),(0,u.CE)("div",Se,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(ht.value,function(e){return(0,u.uX)(),(0,u.CE)("span",{key:e,class:"thumb",onClick:function(t){return function(e){var t="![image](".concat(e,")");(qe.value.message||"").includes(e)||Dt(t)}(e)},title:"\u70b9\u51fb\u63d2\u5165\u5230\u5185\u5bb9",style:{display:"inline-block","margin-right":"8px",cursor:"pointer"}},[(0,u.Lk)("img",{src:e,style:{"max-width":"60px","max-height":"60px","border-radius":"6px",border:"1px solid #eee"}},null,8,De)],8,Ae)}),128))])):(0,u.Q3)("",!0)])]),(0,u.Lk)("div",Re,[(0,u.Lk)("button",{class:"cancel-btn",onClick:it},(0,o.toDisplayString)(e.$t("common.cancel")),1),(0,u.Lk)("button",{class:"submit-btn",onClick:gt,disabled:He.value},[He.value?((0,u.uX)(),(0,u.CE)("span",Te)):(0,u.Q3)("",!0),(0,u.eW)(" "+(0,o.toDisplayString)(e.$t("common.submit")),1)],8,Ee)])])])):(0,u.Q3)("",!0)])),Ve.value?((0,u.uX)(),(0,u.CE)("div",{key:2,class:"modal-overlay",onClick:ft},[(0,u.Lk)("div",{class:"modal-content",onClick:n[6]||(n[6]=(0,d.withModifiers)(function(){},["stop"]))},[(0,u.Lk)("div",Xe,[(0,u.Lk)("h3",null,(0,o.toDisplayString)(e.$t("tickets.closeConfirmTitle")),1),(0,u.Lk)("button",{class:"close-btn",onClick:ft},[(0,u.bF)((0,c.R1)(f.MRt),{size:20})])]),(0,u.Lk)("div",Ke,[(0,u.Lk)("p",null,(0,o.toDisplayString)(e.$t("tickets.closeConfirmText")),1)]),(0,u.Lk)("div",Ie,[(0,u.Lk)("button",{class:"cancel-btn",onClick:ft},(0,o.toDisplayString)(e.$t("common.cancel")),1),(0,u.Lk)("button",{class:"confirm-close-btn danger",onClick:mt,disabled:Ue.value},[Ue.value?((0,u.uX)(),(0,u.CE)("span",Fe,[n[8]||(n[8]=(0,u.Lk)("span",{class:"spinner"},null,-1)),(0,u.eW)(" "+(0,o.toDisplayString)(e.$t("tickets.closing")),1)])):((0,u.uX)(),(0,u.CE)("span",_e,(0,o.toDisplayString)(e.$t("tickets.closeTicket")),1))],8,$e)])])])):(0,u.Q3)("",!0),(0,u.bF)(C.A,{"show-popup":Je.value,title:(0,c.R1)(et).title,content:(0,c.R1)(et).content,"cooldown-hours":(0,c.R1)(et).cooldownHours,"close-wait-seconds":(0,c.R1)(et).closeWaitSeconds,onClose:bt},null,8,["show-popup","title","content","cooldown-hours","close-wait-seconds"])])}}};const ze=(0,n(66262).A)(Me,[["__scopeId","data-v-a0c59dde"]])},69668(e,t,n){n.d(t,{A:()=>m});var a=n(20641),s=n(53751),l=n(90033),i={key:0,class:"ticket-popup-container"},r={class:"ticket-popup-header"},u=["innerHTML"],c={class:"ticket-popup-content"},o=["innerHTML"],d={class:"ticket-popup-footer"},v=["disabled"];n(76918),n(59089),n(23288),n(2892),n(26099),n(38781),n(76031);var p=n(50953);const k={name:"TicketPopup",components:{IconX:n(14860).MRt},props:{showPopup:{type:Boolean,default:!1},title:{type:String,default:""},content:{type:String,default:""},cooldownHours:{type:Number,default:24},closeWaitSeconds:{type:Number,default:0}},emits:["close"],setup:function(e,t){var n=t.emit,s=(0,p.KR)(!1),l=(0,p.KR)(0),i=null;return(0,a.wB)(function(){return e.showPopup},function(t){t?setTimeout(function(){s.value=!0,i&&clearInterval(i),e.closeWaitSeconds>0?(l.value=e.closeWaitSeconds,i=setInterval(function(){l.value>0?l.value-=1:clearInterval(i)},1e3)):l.value=0},1e3):(s.value=!1,i&&clearInterval(i))},{immediate:!0}),(0,a.hi)(function(){i&&clearInterval(i)}),{show:s,attemptClose:function(){if(!(l.value>0)){if(s.value=!1,e.cooldownHours>0){var t=Date.now();localStorage.setItem("ticket_popup_close_time",t.toString())}n("close")}},waitTimeRemaining:l}}};const f=(0,n(66262).A)(k,[["render",function(e,t,n,p,k,f){var m=(0,a.g2)("IconX");return(0,a.uX)(),(0,a.Wv)(s.Transition,{name:"fade"},{default:(0,a.k6)(function(){return[p.show?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"ticket-popup-overlay",onClick:t[2]||(t[2]=(0,s.withModifiers)(function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)},["self"]))},[(0,a.bF)(s.Transition,{name:"popup-slide"},{default:(0,a.k6)(function(){return[p.show?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",r,[(0,a.Lk)("h2",{class:"popup-title",innerHTML:n.title},null,8,u),(0,a.Lk)("button",{class:"popup-close-btn",onClick:t[0]||(t[0]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)})},[(0,a.bF)(m,{size:20})])]),(0,a.Lk)("div",c,[(0,a.Lk)("div",{innerHTML:n.content},null,8,o)]),(0,a.Lk)("div",d,[(0,a.Lk)("button",{class:"popup-action-btn",onClick:t[1]||(t[1]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)}),disabled:p.waitTimeRemaining>0},[p.waitTimeRemaining>0?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,l.toDisplayString)(e.$t("tickets.popup.wait_close_btn",{seconds:p.waitTimeRemaining})),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,l.toDisplayString)(e.$t("tickets.popup.close_btn")),1)],64))],8,v)])])):(0,a.Q3)("",!0)]}),_:1})])):(0,a.Q3)("",!0)]}),_:1})}],["__scopeId","data-v-053c6e2c"]]),m=f},90208(e,t,n){n.d(t,{A:()=>s});n(52675),n(89463),n(2259),n(16280),n(76918),n(26099),n(47764),n(62953);var a=n(54119);function s(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError((0,a.A)(e)+" is not iterable")}}}]);