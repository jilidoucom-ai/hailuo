"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[8470],{8470(e,n,a){a.r(n),a.d(n,{default:()=>w});var t=a(20908),l=a(30388),o=(a(59089),a(76031),a(20641)),s=a(53751),c=a(50953),i=a(90033),r=a(14860),u=a(2636),d=a(12321),v=a(33366),m={class:"modal-header"},p={class:"modal-body"},k={key:0,class:"message-loading"},f={key:1},g={class:"expires"},b={class:"command"},h={class:"info"},_={class:"icon"},L={class:"send"},y=["href"],C={class:"modal-footer"};const S={__name:"TelegramModal",props:{config:{telegram_bot_name:""}},setup:function(e,n){var a=n.expose,S=e,w=(0,v.d)().showToast,I=(0,c.KR)(!1),A=(0,c.KR)(""),T=(0,c.KR)(!1),x=(0,c.KR)(0),D=null,R=null,z=function(){D=setInterval(function(){x.value--},1e3)},X=function(){R=setInterval((0,l.A)((0,t.A)().m(function e(){var n,a,l,o,s,c;return(0,t.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,u.checkTelegram)({code:A.value});case 1:n=e.v,a=n.status,l=n.data,"success"===a&&(clearInterval(R),o=l.auth_data,s=l.is_admin,c=l.token,localStorage.setItem("token",c),localStorage.setItem("is_admin",s),localStorage.setItem("auth_data",o),setTimeout(function(){localStorage.setItem("oauth_login_success",Date.now()),I.value=!1,window.location.reload()},500)),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])})),1e3)},E=function(){var e=(0,l.A)((0,t.A)().m(function e(){var n,a,l,o;return(0,t.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return clearInterval(D),clearTimeout(R),T.value=!0,e.p=1,e.n=2,(0,u.getTelegramCode)();case 2:n=e.v,a=n.data,l=a.hash,o=a.expires_in,A.value=l,x.value=o,z(),X(),e.n=4;break;case 3:e.p=3,e.v;case 4:return e.p=4,T.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),K=function(){navigator.clipboard.writeText("/login ".concat(A.value)).then(function(){w("\u590d\u5236\u6210\u529f","success",3e3)}).catch(function(){w("\u590d\u5236\u5931\u8d25","error",3e3)})},M=function(){clearInterval(D),clearTimeout(R),I.value=!1};return(0,o.wB)(function(){return I.value},function(e){e||(clearInterval(D),clearTimeout(R))},{immediate:!0,deep:!0}),a({openModal:function(){E(),I.value=!0}}),function(e,n){return(0,o.uX)(),(0,o.Wv)(o.Im,{to:"body"},[I.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:M},[(0,o.Lk)("div",{class:"modal-content",onClick:n[0]||(n[0]=(0,s.withModifiers)(function(){},["stop"]))},[(0,o.Lk)("div",m,[n[1]||(n[1]=(0,o.Lk)("h3",null,"Telegram \u767b\u5f55",-1)),(0,o.Lk)("button",{class:"close-btn",onClick:M},[(0,o.bF)((0,c.R1)(r.MRt),{size:20})])]),(0,o.Lk)("div",p,[T.value?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.bF)(d.A),(0,o.Lk)("p",null,(0,i.toDisplayString)(e.$t("common.loading")),1)])):((0,o.uX)(),(0,o.CE)("ol",f,[(0,o.Lk)("li",null,[(0,o.Lk)("div",null,[n[2]||(n[2]=(0,o.eW)(" 1.\u590d\u5236\u547d\u4ee4 ",-1)),(0,o.Lk)("span",g,(0,i.toDisplayString)(x.value)+"s ",1),n[3]||(n[3]=(0,o.eW)(" \u540e\u8fc7\u671f ",-1)),n[4]||(n[4]=(0,o.Lk)("br",null,null,-1))]),(0,o.Lk)("div",b,[(0,o.Lk)("div",h," /login "+(0,i.toDisplayString)(A.value),1),(0,o.Lk)("div",_,[(0,o.bF)((0,c.R1)(r.bzS),{size:24,onClick:K})])])]),(0,o.Lk)("li",L,[n[5]||(n[5]=(0,o.eW)(" 2.\u53d1\u9001\u7ed9 ",-1)),(0,o.Lk)("a",{href:"https://t.me/".concat(S.config.telegram_bot_name),target:"_blank"}," @"+(0,i.toDisplayString)(S.config.telegram_bot_name),9,y)])]))]),(0,o.Lk)("div",C,[(0,o.Lk)("button",{class:"cancel-btn",onClick:M},(0,i.toDisplayString)(e.$t("common.cancel")),1),(0,o.Lk)("button",{class:"submit-btn",onClick:M},(0,i.toDisplayString)(e.$t("common.submit")),1)])])])):(0,o.Q3)("",!0)])}}};const w=(0,a(66262).A)(S,[["__scopeId","data-v-736f0af8"]])},12321(e,n,a){a.d(n,{A:()=>c});var t=a(20641),l=a(90033),o={key:0,class:"spinner-text"};const s={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const c=(0,a(66262).A)(s,[["render",function(e,n,a,s,c,i){return(0,t.uX)(),(0,t.CE)("div",{class:(0,l.normalizeClass)(["loading-spinner",{"loading-spinner-overlay":a.overlay}])},[n[0]||(n[0]=(0,t.Lk)("div",{class:"spinner"},[(0,t.Lk)("div",{class:"spinner-circle"})],-1)),a.text?((0,t.uX)(),(0,t.CE)("div",o,(0,l.toDisplayString)(a.text),1)):(0,t.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])}}]);