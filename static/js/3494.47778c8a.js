"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[3494],{12321(e,t,a){a.d(t,{A:()=>r});var n=a(20641),s=a(90033),l={key:0,class:"spinner-text"};const i={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const r=(0,a(66262).A)(i,[["render",function(e,t,a,i,r,u){return(0,n.uX)(),(0,n.CE)("div",{class:(0,s.normalizeClass)(["loading-spinner",{"loading-spinner-overlay":a.overlay}])},[t[0]||(t[0]=(0,n.Lk)("div",{class:"spinner"},[(0,n.Lk)("div",{class:"spinner-circle"})],-1)),a.text?((0,n.uX)(),(0,n.CE)("div",l,(0,s.toDisplayString)(a.text),1)):(0,n.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},46510(e,t,a){a.d(t,{F$:()=>s,Hi:()=>u,RV:()=>r,Z2:()=>l,yN:()=>i});var n=a(19043);function s(){return(0,n.A)({url:"/user/ticket/fetch",method:"get"})}function l(e){return(0,n.A)({url:"/user/ticket/save",method:"post",data:e})}function i(e){return(0,n.A)({url:"/user/ticket/fetch?id=".concat(e),method:"get"})}function r(e,t){return(0,n.A)({url:"/user/ticket/reply",method:"post",data:{id:e,message:t}})}function u(e){return(0,n.A)({url:"/user/ticket/close",method:"post",data:{id:e}})}},69668(e,t,a){a.d(t,{A:()=>f});var n=a(20641),s=a(53751),l=a(90033),i={key:0,class:"ticket-popup-container"},r={class:"ticket-popup-header"},u=["innerHTML"],o={class:"ticket-popup-content"},c=["innerHTML"],v={class:"ticket-popup-footer"},d=["disabled"];a(76918),a(59089),a(23288),a(2892),a(26099),a(38781),a(76031);var p=a(50953);const k={name:"TicketPopup",components:{IconX:a(14860).MRt},props:{showPopup:{type:Boolean,default:!1},title:{type:String,default:""},content:{type:String,default:""},cooldownHours:{type:Number,default:24},closeWaitSeconds:{type:Number,default:0}},emits:["close"],setup:function(e,t){var a=t.emit,s=(0,p.KR)(!1),l=(0,p.KR)(0),i=null;return(0,n.wB)(function(){return e.showPopup},function(t){t?setTimeout(function(){s.value=!0,i&&clearInterval(i),e.closeWaitSeconds>0?(l.value=e.closeWaitSeconds,i=setInterval(function(){l.value>0?l.value-=1:clearInterval(i)},1e3)):l.value=0},1e3):(s.value=!1,i&&clearInterval(i))},{immediate:!0}),(0,n.hi)(function(){i&&clearInterval(i)}),{show:s,attemptClose:function(){if(!(l.value>0)){if(s.value=!1,e.cooldownHours>0){var t=Date.now();localStorage.setItem("ticket_popup_close_time",t.toString())}a("close")}},waitTimeRemaining:l}}};const m=(0,a(66262).A)(k,[["render",function(e,t,a,p,k,m){var f=(0,n.g2)("IconX");return(0,n.uX)(),(0,n.Wv)(s.Transition,{name:"fade"},{default:(0,n.k6)(function(){return[p.show?((0,n.uX)(),(0,n.CE)("div",{key:0,class:"ticket-popup-overlay",onClick:t[2]||(t[2]=(0,s.withModifiers)(function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)},["self"]))},[(0,n.bF)(s.Transition,{name:"popup-slide"},{default:(0,n.k6)(function(){return[p.show?((0,n.uX)(),(0,n.CE)("div",i,[(0,n.Lk)("div",r,[(0,n.Lk)("h2",{class:"popup-title",innerHTML:a.title},null,8,u),(0,n.Lk)("button",{class:"popup-close-btn",onClick:t[0]||(t[0]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)})},[(0,n.bF)(f,{size:20})])]),(0,n.Lk)("div",o,[(0,n.Lk)("div",{innerHTML:a.content},null,8,c)]),(0,n.Lk)("div",v,[(0,n.Lk)("button",{class:"popup-action-btn",onClick:t[1]||(t[1]=function(){return p.attemptClose&&p.attemptClose.apply(p,arguments)}),disabled:p.waitTimeRemaining>0},[p.waitTimeRemaining>0?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.eW)((0,l.toDisplayString)(e.$t("tickets.popup.wait_close_btn",{seconds:p.waitTimeRemaining})),1)],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[(0,n.eW)((0,l.toDisplayString)(e.$t("tickets.popup.close_btn")),1)],64))],8,d)])])):(0,n.Q3)("",!0)]}),_:1})])):(0,n.Q3)("",!0)]}),_:1})}],["__scopeId","data-v-053c6e2c"]]),f=m},83494(e,t,a){a.r(t),a.d(t,{default:()=>Ge});var n=a(41034),s=a(78676),l=a(90208),i=a(20908),r=a(30388),u=(a(16280),a(76918),a(28706),a(2008),a(23418),a(74423),a(64346),a(62062),a(44114),a(34782),a(59089),a(23288),a(18111),a(22489),a(61701),a(2892),a(26099),a(58940),a(99449),a(21699),a(47764),a(11392),a(42762),a(62953),a(76031),a(20641)),o=a(50953),c=a(90033),v=a(53751),d=a(46992),p=a(71029),k=a(25506),m=a(14860),f=a(46510),g=a(92549),y=a(49586),b=a(12321),h=a(33366),L=a(69668),C=a(80394),w={class:"ticket-container"},S={key:0,class:"screen-size-notice"},R={class:"notice-content"},A={class:"dashboard-card welcome-card"},D={class:"card-header"},E={class:"card-title"},T={class:"card-body"},X={class:"ticket-list-container"},K={class:"ticket-sidebar"},_={class:"ticket-header"},$={class:"search-box"},z=["placeholder"],I={key:0,class:"ticket-list"},F=["onClick"],x={class:"ticket-info"},M={class:"ticket-subject"},W={class:"ticket-meta"},j={class:"ticket-time"},Q={class:"ticket-status"},H={key:1,class:"ticket-loading"},N={key:2,class:"empty-state"},P={class:"ticket-content"},B={class:"ticket-detail-header"},G={class:"ticket-subject-info"},O={class:"ticket-detail-meta"},V={class:"ticket-time"},U={class:"ticket-actions"},Y=["disabled"],q={key:0},Z={key:1,class:"loading-text"},J={class:"ticket-detail-content"},ee={class:"ticket-messages"},te={key:0,class:"message-loading"},ae={key:1,class:"no-messages"},ne={key:0,class:"message-avatar admin-avatar"},se={class:"message-content"},le={class:"message-header"},ie={key:0,class:"message-sender"},re=["innerHTML"],ue={key:1,class:"message-avatar user-avatar"},oe={class:"message-time-floating"},ce={key:0,class:"reply-container"},ve=["placeholder","onKeydown"],de={class:"reply-tools",style:{display:"flex",gap:"8px","align-items":"center"}},pe=["disabled"],ke={key:1,class:"loader"},me={key:2},fe={key:3},ge=["disabled"],ye={key:0,class:"loader"},be={key:1,class:"ticket-closed-notice"},he={key:1,class:"no-selection"},Le={class:"modal-header"},Ce={class:"modal-body"},we={class:"form-group"},Se=["placeholder"],Re={class:"form-group"},Ae={class:"level-tags"},De={class:"form-group"},Ee=["placeholder"],Te={class:"upload-tip"},Xe={class:"upload-tip-text"},Ke={class:"upload-desc"},_e={key:1,style:{"margin-top":"8px",color:"#2196f3"}},$e={key:2,style:{"margin-top":"8px"}},ze=["onClick"],Ie=["src"],Fe={class:"modal-footer"},xe=["disabled"],Me={key:0,class:"loader"},We={class:"modal-header"},je={class:"modal-body"},Qe={class:"modal-footer"},He=["disabled"],Ne={key:0,class:"loader"},Pe="https://api.imgbb.com/1/upload";const Be={__name:"TicketList",setup:function(e){var t=new k.A({linkify:!0,breaks:!0}),a=(0,d.s9)().t,Be=(0,h.d)().showToast,Ge=(0,o.KR)([]),Oe=(0,o.KR)(null),Ve=(0,o.KR)(""),Ue=(0,o.KR)(!1),Ye=(0,o.KR)(!1),qe=(0,o.KR)([]),Ze=(0,o.KR)(!1),Je=(0,o.KR)(""),et=(0,o.KR)(!1),tt=(0,o.KR)(!1),at=(0,o.KR)(!1),nt=(0,o.KR)(!1),st=(0,o.KR)(null),lt=(0,o.KR)([]),it=(0,o.KR)(!1),rt=(0,o.KR)(!1),ut=(0,o.KR)(null),ot=(0,o.KR)(null),ct=(0,o.KR)(0),vt=function(){var e,t=ot.value;t&&(ct.value=null!==(e=t.selectionStart)&&void 0!==e?e:Et.value.message.length)},dt=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,n,s,l,r,o,c,v;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(l=ot.value,r=Et.value.message||"",l){e.n=1;break}return Et.value.message=r+(r&&!r.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return o=null!==(a=null!==(n=l.selectionStart)&&void 0!==n?n:ct.value)&&void 0!==a?a:r.length,c=null!==(s=l.selectionEnd)&&void 0!==s?s:o,Et.value.message=r.slice(0,o)+t+r.slice(c),e.n=2,(0,u.dY)();case 2:v=o+t.length,l.focus(),l.setSelectionRange(v,v),ct.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),pt=C.TICKET_CONFIG.imgbbApiKey,kt=function(){ut.value&&ut.value.click()},mt=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(rt.value=!1,!(a=Array.from(t.dataTransfer.files).filter(function(e){return e.type.startsWith("image/")})).length){e.n=1;break}return e.n=1,ft({target:{files:a}});case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,n,s,r;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if((a=Array.from(t.target.files)).length){e.n=1;break}return e.a(2);case 1:it.value=!0,n=(0,i.A)().m(function e(){var t,a,n,l,u,o;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!((t=r[s]).size>5242880)){e.n=1;break}return Be("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(2,1);case 1:return e.p=1,e.n=2,new Promise(function(e,a){var n=new FileReader;n.onload=function(){return e(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(t)});case 2:return a=e.v,(n=new FormData).append("image",a),e.n=3,fetch("".concat(Pe,"?key=").concat(pt),{method:"POST",body:n});case 3:return l=e.v,e.n=4,l.json();case 4:(u=e.v).success&&u.data&&u.data.url?(lt.value.push(u.data.url),Et.value.message+="\n![image](".concat(u.data.url,")")):Be((null===(o=u.error)||void 0===o?void 0:o.message)||"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25","error"),e.n=6;break;case 5:e.p=5,e.v,Be("\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 6:return e.a(2)}},e,null,[[1,5]])}),s=0,r=a;case 2:if(!(s<r.length)){e.n=5;break}return e.d((0,l.A)(n()),3);case 3:if(!e.v){e.n=4;break}return e.a(3,4);case 4:s++,e.n=2;break;case 5:it.value=!1;case 6:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),gt=(0,o.KR)(null),yt=(0,o.KR)(null),bt=(0,o.KR)(!1),ht=(0,o.KR)(0),Lt=function(){gt.value&&gt.value.click()},Ct=function(){var e,t=yt.value;t&&(ht.value=null!==(e=t.selectionStart)&&void 0!==e?e:Je.value.length)},wt=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,n,s,l,r,o,c,v;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:if(l=yt.value,r=Je.value||"",l){e.n=1;break}return Je.value=r+(r&&!r.endsWith("\n")?"\n":"")+t+"\n",e.a(2);case 1:return o=null!==(a=null!==(n=l.selectionStart)&&void 0!==n?n:ht.value)&&void 0!==a?a:r.length,c=null!==(s=l.selectionEnd)&&void 0!==s?s:o,Je.value=r.slice(0,o)+t+r.slice(c),e.n=2,(0,u.dY)();case 2:v=o+t.length,l.focus(),l.setSelectionRange(v,v),ht.value=v;case 3:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),St=function(e){return new Promise(function(t,a){var n=new FileReader;n.onload=function(){return t(n.result.split(",")[1])},n.onerror=a,n.readAsDataURL(e)})},Rt=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,n,s,l,r,u;return(0,i.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,St(t);case 1:return s=e.v,(l=new FormData).append("image",s),e.n=2,fetch("".concat(Pe,"?key=").concat(pt),{method:"POST",body:l});case 2:return r=e.v,e.n=3,r.json();case 3:if(!(u=e.v).success||null===(a=u.data)||void 0===a||!a.url){e.n=4;break}return e.a(2,u.data.url);case 4:throw new Error((null===(n=u.error)||void 0===n?void 0:n.message)||"imgbb \u4e0a\u4f20\u5931\u8d25");case 5:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}(),At=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var a,n,s,l,r,u,o,c;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if((a=Array.from(t.target.files||[])).length){e.n=1;break}return e.a(2);case 1:bt.value=!0,e.p=2,s=0,l=a;case 3:if(!(s<l.length)){e.n=7;break}if(!((r=l[s]).size>5242880)){e.n=4;break}return Be("\u56fe\u7247\u4e0d\u80fd\u8d85\u8fc7 5MB","error"),e.a(3,6);case 4:return e.n=5,Rt(r);case 5:return u=e.v,o="![image](".concat(u,")"),e.n=6,wt(o);case 6:s++,e.n=3;break;case 7:Be((null===(n=$t)||void 0===n?void 0:n("tickets.uploadSuccess"))||"\u56fe\u7247\u4e0a\u4f20\u6210\u529f","success"),e.n=9;break;case 8:e.p=8,c=e.v,Be(c.message||"\u56fe\u7247\u4e0a\u4f20\u5f02\u5e38","error");case 9:return e.p=9,bt.value=!1,gt.value&&(gt.value.value=""),e.f(9);case 10:return e.a(2)}},e,null,[[2,8,9,10]])}));return function(t){return e.apply(this,arguments)}}(),Dt=(0,o.KR)({subject:"",message:""}),Et=(0,o.KR)({subject:"",message:"",level:"0"}),Tt=(0,u.EW)(function(){if(!Ve.value)return Ge.value;var e=Ve.value.toLowerCase();return Ge.value.filter(function(t){return t.subject.toLowerCase().includes(e)})}),Xt=function(){var e=(0,r.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return nt.value=!0,e.p=1,e.n=2,(0,f.F$)();case 2:t=e.v,Ge.value=Array.isArray(t.data)?t.data:[],e.n=4;break;case 3:e.p=3,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.fetchError"),"error"),Ge.value=[];case 4:return e.p=4,nt.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),Kt=function(){var e=(0,r.A)((0,i.A)().m(function e(){var t,n,l,r,u,o,c,v,d,p,k,m;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Et.value.subject.trim()){e.n=1;break}return Dt.value.subject=a("tickets.subjectRequired"),e.a(2);case 1:Dt.value.subject="";case 2:if(Et.value.message.trim()){e.n=3;break}return Dt.value.message=a("tickets.messageRequired"),e.a(2);case 3:Dt.value.message="";case 4:return Ye.value=!0,e.p=5,e.n=6,Promise.all([(0,g.ug)(),(0,g.l8)(),(0,g._8)(),(0,g.XL)()]);case 6:return t=e.v,n=(0,s.A)(t,4),l=n[0],r=n[1],u=n[2],o=n[3],r&&r.data&&r.data.currency_symbol&&(l.currency_symbol=r.data.currency_symbol),c=(0,y.AB)(l,o,u),v="".concat(Et.value.message,"\n\n").concat(c),e.n=7,(0,f.Z2)({subject:Et.value.subject,message:v,level:parseInt(Et.value.level)});case 7:if(!(d=e.v).data){e.n=9;break}return Be(d.message||a("tickets.createSuccess"),"success"),Gt(),e.n=8,Xt();case 8:Ge.value.length>0&&(p=Ge.value[0],Nt(p));case 9:e.n=11;break;case 10:e.p=10,m=e.v,Be((null===(k=m.response)||void 0===k?void 0:k.message)||m.message||a("tickets.createError"),"error");case 11:return e.p=11,Ye.value=!1,e.f(11);case 12:return e.a(2)}},e,null,[[5,10,11,12]])}));return function(){return e.apply(this,arguments)}}(),_t=function(){var e=(0,r.A)((0,i.A)().m(function e(t){var s,l,r,u,o=arguments;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return(s=o.length>1&&void 0!==o[1]&&o[1])||(Ze.value=!0,qe.value=[]),e.p=1,e.n=2,(0,f.yN)(t);case 2:(l=e.v).data&&(l.data.message&&Array.isArray(l.data.message)?qe.value=l.data.message.map(function(e){return(0,n.A)((0,n.A)({},e),{},{is_admin:!e.is_me})}):qe.value=[],Oe.value&&Oe.value.id===t&&void 0!==l.data.status&&(Oe.value.status=l.data.status,1===l.data.status&&zt())),e.n=4;break;case 3:e.p=3,u=e.v,Be((null===(r=u.response)||void 0===r?void 0:r.message)||u.message||a("tickets.fetchDetailError"),"error");case 4:return e.p=4,s||(Ze.value=!1),e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(t){return e.apply(this,arguments)}}(),zt=function(){st.value&&(clearInterval(st.value),st.value=null)},It=function(){var e=(0,r.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Je.value.trim()&&Oe.value){e.n=1;break}return e.a(2);case 1:return et.value=!0,e.p=2,e.n=3,(0,f.RV)(Oe.value.id,Je.value);case 3:if(!(t=e.v).data){e.n=4;break}return Be(t.message||a("tickets.replySent"),"success"),Je.value="",e.n=4,_t(Oe.value.id,!0);case 4:e.n=6;break;case 5:e.p=5,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.replyError"),"error");case 6:return e.p=6,et.value=!1,e.f(6);case 7:return e.a(2)}},e,null,[[2,5,6,7]])}));return function(){return e.apply(this,arguments)}}(),Ft=function(){var e=(0,r.A)((0,i.A)().m(function e(){var t,n,s;return(0,i.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Oe.value){e.n=1;break}return e.a(2);case 1:return at.value=!0,e.p=2,e.n=3,(0,f.Hi)(Oe.value.id);case 3:if(!0!==(t=e.v).data){e.n=6;break}return Be(t.message||a("tickets.closeSuccess"),"success"),Oe.value.status=1,zt(),e.n=4,_t(Oe.value.id);case 4:return e.n=5,Xt();case 5:Pt.value=!0,Bt.value=!1,setTimeout(function(){tt.value=!1,Pt.value=!1},250);case 6:e.n=8;break;case 7:e.p=7,s=e.v,Be((null===(n=s.response)||void 0===n?void 0:n.message)||s.message||a("tickets.closeError"),"error");case 8:return e.p=8,at.value=!1,e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(){return e.apply(this,arguments)}}(),xt=function(e){return e?new Date(1e3*e).toLocaleString():"--"},Mt=function(e){return a(0===e?"tickets.statusOpen":"tickets.statusClosed")},Wt=function(e){return 0===e?"status-open":"status-closed"},jt=function(e){var t={0:a("tickets.levelLow"),1:a("tickets.levelMedium"),2:a("tickets.levelHigh")};return t[e]||t[0]},Qt=function(e){var t={0:"level-low",1:"level-medium",2:"level-high"};return t[e]||t[0]},Ht=function(){},Nt=function(e){var t;zt(),Oe.value=e,_t(e.id),0===e.status&&(t=e.id,zt(),Oe.value&&0===Oe.value.status&&(st.value=setInterval(function(){Oe.value&&Oe.value.id===t?_t(t,!0):zt()},5e3)))},Pt=(0,o.KR)(!1),Bt=(0,o.KR)(!1),Gt=function(){Pt.value=!0,Bt.value=!1,setTimeout(function(){Ue.value=!1,Pt.value=!1,Et.value={subject:"",message:"",level:"0"}},250)},Ot=function(){Pt.value=!1,Ue.value=!0,setTimeout(function(){Bt.value=!0},10)},Vt=function(){tt.value?(Pt.value=!0,Bt.value=!1,setTimeout(function(){tt.value=!1,Pt.value=!1},250)):(Pt.value=!1,tt.value=!0,setTimeout(function(){Bt.value=!0},10))},Ut=function(e,t){return 0===e||qe.value[e-1].is_admin!==t},Yt=function(e){if(!e)return"--";var t=new Date(1e3*e),a=new Date;return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.getDate()+"\u65e5 "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},qt=(0,o.KR)(!1),Zt=(0,p.rd)(),Jt=function(){qt.value=window.innerWidth<905},ea=function(){Zt.push("/mobile/tickets")},ta=(0,o.KR)(!1),aa=(null===C.TICKET_CONFIG||void 0===C.TICKET_CONFIG?void 0:C.TICKET_CONFIG.popup)||{},na=function(){ta.value=!1};return(0,u.sV)(function(){Jt(),window.addEventListener("resize",Jt),Xt(),function(){if(aa.enabled){var e=Number(localStorage.getItem("ticket_popup_close_time")||0),t=3600*(aa.cooldownHours||0)*1e3;(!e||Date.now()-e>=t)&&(ta.value=!0)}}()}),(0,u.hi)(function(){window.removeEventListener("resize",Jt),zt()}),function(e,a){return(0,u.uX)(),(0,u.CE)("div",w,[qt.value?((0,u.uX)(),(0,u.CE)("div",S,[(0,u.Lk)("div",R,[(0,u.bF)((0,o.R1)(m.q2Q),{size:48}),(0,u.Lk)("h2",null,(0,c.toDisplayString)(e.$t("tickets.smallScreenNotice")),1),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.switchToMobile")),1),(0,u.Lk)("button",{class:"switch-btn",onClick:ea},(0,c.toDisplayString)(e.$t("tickets.switchToMobileView")),1)])])):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.Lk)("div",A,[(0,u.Lk)("div",D,[(0,u.Lk)("h2",E,(0,c.toDisplayString)(e.$t("tickets.title")),1)]),(0,u.Lk)("div",T,[(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.description")),1)])]),(0,u.Lk)("div",X,[(0,u.Lk)("div",K,[(0,u.Lk)("div",_,[(0,u.Lk)("div",$,[(0,u.bo)((0,u.Lk)("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=function(e){return Ve.value=e}),placeholder:e.$t("tickets.searchPlaceholder"),onInput:Ht},null,40,z),[[v.vModelText,Ve.value]]),(0,u.bF)((0,o.R1)(m.C0l),{size:16,class:"search-icon"})]),(0,u.Lk)("button",{class:"new-ticket-btn",onClick:Ot},[(0,u.bF)((0,o.R1)(m.uID),{size:16}),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.newTicket")),1)])]),Ge.value.length>0&&!nt.value?((0,u.uX)(),(0,u.CE)("div",I,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(Tt.value,function(e){var t;return(0,u.uX)(),(0,u.CE)("div",{key:e.id,class:(0,c.normalizeClass)(["ticket-item",{active:(null===(t=Oe.value)||void 0===t?void 0:t.id)===e.id}]),onClick:function(t){return Nt(e)}},[(0,u.Lk)("div",x,[(0,u.Lk)("h3",M,(0,c.toDisplayString)(e.subject),1),(0,u.Lk)("div",W,[(0,u.Lk)("span",j,(0,c.toDisplayString)(xt(e.updated_at)),1),(0,u.Lk)("div",Q,[(0,u.Lk)("span",{class:(0,c.normalizeClass)(["status-badge",Wt(e.status)])},(0,c.toDisplayString)(Mt(e.status)),3),(0,u.Lk)("span",{class:(0,c.normalizeClass)(["level-badge",Qt(e.level)])},(0,c.toDisplayString)(jt(e.level)),3)])])])],10,F)}),128))])):nt.value?((0,u.uX)(),(0,u.CE)("div",H,[(0,u.bF)(b.A),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.loadingTickets")),1)])):((0,u.uX)(),(0,u.CE)("div",N,[(0,u.bF)((0,o.R1)(m.yg_),{size:48,class:"empty-icon"}),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.noTickets")),1)]))]),(0,u.Lk)("div",P,[Oe.value?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.Lk)("div",B,[(0,u.Lk)("div",G,[(0,u.Lk)("h2",null,(0,c.toDisplayString)(Oe.value.subject),1),(0,u.Lk)("div",O,[(0,u.Lk)("span",{class:(0,c.normalizeClass)(["status-badge",Wt(Oe.value.status)])},(0,c.toDisplayString)(Mt(Oe.value.status)),3),(0,u.Lk)("span",{class:(0,c.normalizeClass)(["level-badge",Qt(Oe.value.level)])},(0,c.toDisplayString)(jt(Oe.value.level)),3),(0,u.Lk)("span",V,(0,c.toDisplayString)(e.$t("tickets.createdAt"))+": "+(0,c.toDisplayString)(xt(Oe.value.created_at)),1)])]),(0,u.Lk)("div",U,[0===Oe.value.status?((0,u.uX)(),(0,u.CE)("button",{key:0,class:"close-ticket-btn",onClick:a[1]||(a[1]=function(e){return Vt()}),disabled:at.value},[at.value?((0,u.uX)(),(0,u.CE)("span",Z,[a[14]||(a[14]=(0,u.Lk)("span",{class:"loading-spinner"},null,-1)),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.closing")),1)])):((0,u.uX)(),(0,u.CE)("span",q,(0,c.toDisplayString)(e.$t("tickets.closeTicket")),1))],8,Y)):(0,u.Q3)("",!0)])]),(0,u.Lk)("div",J,[(0,u.Lk)("div",ee,[Ze.value?((0,u.uX)(),(0,u.CE)("div",te,[(0,u.bF)(b.A),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.loadingMessages")),1)])):0===qe.value.length?((0,u.uX)(),(0,u.CE)("div",ae,[(0,u.bF)((0,o.R1)(m.bYO),{size:64,class:"no-messages-icon"}),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.noMessages")),1)])):((0,u.uX)(!0),(0,u.CE)(u.FK,{key:2},(0,u.pI)(qe.value,function(a,n){return(0,u.uX)(),(0,u.CE)("div",{key:a.id,class:(0,c.normalizeClass)(["message-item",{"admin-message":a.is_admin,"user-message":!a.is_admin}])},[a.is_admin?((0,u.uX)(),(0,u.CE)("div",ne,[(0,u.bF)((0,o.R1)(m.ut_))])):(0,u.Q3)("",!0),(0,u.Lk)("div",se,[(0,u.Lk)("div",le,[Ut(n,a.is_admin)?((0,u.uX)(),(0,u.CE)("span",ie,(0,c.toDisplayString)(a.is_admin?e.$t("tickets.admin"):e.$t("tickets.you")),1)):(0,u.Q3)("",!0)]),(0,u.Lk)("div",{class:"message-text",innerHTML:(0,o.R1)(t).render(a.message)},null,8,re)]),a.is_admin?(0,u.Q3)("",!0):((0,u.uX)(),(0,u.CE)("div",ue,[(0,u.bF)((0,o.R1)(m.vg7))])),(0,u.Lk)("span",oe,(0,c.toDisplayString)(Yt(a.created_at)),1)],2)}),128))])]),0===Oe.value.status?((0,u.uX)(),(0,u.CE)("div",ce,[(0,u.bo)((0,u.Lk)("textarea",{ref_key:"replyTextarea",ref:yt,"onUpdate:modelValue":a[2]||(a[2]=function(e){return Je.value=e}),placeholder:e.$t("tickets.replyPlaceholder"),rows:"3",onKeydown:(0,v.withKeys)((0,v.withModifiers)(It,["ctrl"]),["enter"]),onKeyup:Ct,onClick:Ct},null,40,ve),[[v.vModelText,Je.value]]),(0,u.Lk)("div",de,[(0,u.Lk)("button",{class:"send-reply-btn",type:"button",onClick:Lt,disabled:bt.value},[bt.value?((0,u.uX)(),(0,u.CE)("span",ke)):((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.GYm),{key:0,size:18})),bt.value?((0,u.uX)(),(0,u.CE)("span",fe,(0,c.toDisplayString)(e.$t("tickets.uploadingImages")||"\u4e0a\u4f20\u4e2d"),1)):((0,u.uX)(),(0,u.CE)("span",me,(0,c.toDisplayString)(e.$t("tickets.upPictures")||"\u4e0a\u4f20\u56fe\u7247"),1))],8,pe),(0,u.Lk)("button",{class:"send-reply-btn",onClick:It,disabled:!Je.value.trim()||et.value},[et.value?((0,u.uX)(),(0,u.CE)("span",ye)):((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.mDt),{key:1,size:18})),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.send")),1)],8,ge)]),(0,u.Lk)("input",{ref_key:"replyImageInput",ref:gt,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:At},null,544)])):((0,u.uX)(),(0,u.CE)("div",be,[(0,u.bF)((0,o.R1)(m.XEb),{size:20}),(0,u.Lk)("span",null,(0,c.toDisplayString)(e.$t("tickets.ticketClosed")),1)]))],64)):((0,u.uX)(),(0,u.CE)("div",he,[(0,u.bF)((0,o.R1)(m.pjm),{size:64,class:"no-selection-icon"}),(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.selectTicket")),1)]))])]),((0,u.uX)(),(0,u.Wv)(u.Im,{to:"body"},[Ue.value?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,c.normalizeClass)(["modal-overlay",{"show-overlay":Bt.value}]),onClick:Gt},[(0,u.Lk)("div",{class:(0,c.normalizeClass)(["modal-content",{"modal-close-animation":Pt.value}]),onClick:a[10]||(a[10]=(0,v.withModifiers)(function(){},["stop"]))},[(0,u.Lk)("div",Le,[(0,u.Lk)("h3",null,(0,c.toDisplayString)(e.$t("tickets.createNew")),1),(0,u.Lk)("button",{class:"modal-close",onClick:Gt},[(0,u.bF)((0,o.R1)(m.MRt),{size:20})])]),(0,u.Lk)("div",Ce,[(0,u.Lk)("div",we,[(0,u.Lk)("label",null,(0,c.toDisplayString)(e.$t("tickets.subject")),1),(0,u.bo)((0,u.Lk)("input",{type:"text","onUpdate:modelValue":a[3]||(a[3]=function(e){return Et.value.subject=e}),placeholder:e.$t("tickets.subjectPlaceholder")},null,8,Se),[[v.vModelText,Et.value.subject]])]),(0,u.Lk)("div",Re,[(0,u.Lk)("label",null,(0,c.toDisplayString)(e.$t("tickets.level")),1),(0,u.Lk)("div",Ae,[(0,u.Lk)("div",{class:(0,c.normalizeClass)(["level-tag",{active:"0"===Et.value.level,"level-low":!0}]),onClick:a[4]||(a[4]=function(e){return Et.value.level="0"})},["0"===Et.value.level?((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.levelLow")),1)],2),(0,u.Lk)("div",{class:(0,c.normalizeClass)(["level-tag",{active:"1"===Et.value.level,"level-medium":!0}]),onClick:a[5]||(a[5]=function(e){return Et.value.level="1"})},["1"===Et.value.level?((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.levelMedium")),1)],2),(0,u.Lk)("div",{class:(0,c.normalizeClass)(["level-tag",{active:"2"===Et.value.level,"level-high":!0}]),onClick:a[6]||(a[6]=function(e){return Et.value.level="2"})},["2"===Et.value.level?((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.iQ6),{key:0,size:16,class:"tag-icon"})):((0,u.uX)(),(0,u.Wv)((0,o.R1)(m.ABt),{key:1,size:16,class:"tag-icon"})),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("tickets.levelHigh")),1)],2)])]),(0,u.Lk)("div",De,[(0,u.Lk)("label",null,(0,c.toDisplayString)(e.$t("tickets.message")),1),(0,u.bo)((0,u.Lk)("textarea",{ref_key:"newTicketTextarea",ref:ot,"onUpdate:modelValue":a[7]||(a[7]=function(e){return Et.value.message=e}),placeholder:e.$t("tickets.messagePlaceholder"),rows:"5",onKeyup:vt,onClick:vt},null,40,Ee),[[v.vModelText,Et.value.message]]),(0,o.R1)(C.TICKET_CONFIG).isImageHosting?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,c.normalizeClass)(["image-upload-area",{dragging:rt.value}]),onDragover:a[8]||(a[8]=(0,v.withModifiers)(function(e){return rt.value=!0},["prevent"])),onDragleave:a[9]||(a[9]=(0,v.withModifiers)(function(e){return rt.value=!1},["prevent"])),onDrop:(0,v.withModifiers)(mt,["prevent"]),onClick:kt},[a[16]||(a[16]=(0,u.Lk)("div",{class:"upload-icon"},[(0,u.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"icon icon-tabler icons-tabler-outline icon-tabler-cloud-up"},[(0,u.Lk)("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),(0,u.Lk)("path",{d:"M12 18.004h-5.343c-2.572 -.004 -4.657 -2.011 -4.657 -4.487c0 -2.475 2.085 -4.482 4.657 -4.482c.393 -1.762 1.794 -3.2 3.675 -3.773c1.88 -.572 3.956 -.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.38 0 2.57 .811 3.128 1.986"}),(0,u.Lk)("path",{d:"M19 22v-6"}),(0,u.Lk)("path",{d:"M22 19l-3 -3l-3 3"})])],-1)),(0,u.Lk)("div",Te,[(0,u.Lk)("span",Xe,(0,c.toDisplayString)(e.$t("tickets.uploadTipText")||"\u62d6\u62fd\u56fe\u7247\u5230\u6b64\u5904\u6216\u70b9\u51fb\u4e0a\u4f20"),1),a[15]||(a[15]=(0,u.Lk)("br",null,null,-1)),(0,u.Lk)("span",Ke,(0,c.toDisplayString)(e.$t("tickets.uploadDescText")||"\u652f\u6301 JPG\u3001PNG\u3001GIF \u683c\u5f0f\uff0c\u6700\u5927 5 MB"),1)]),(0,u.Lk)("input",{ref_key:"imageInput",ref:ut,type:"file",accept:"image/*",multiple:"",style:{display:"none"},onChange:ft},null,544)],34)):(0,u.Q3)("",!0),it.value?((0,u.uX)(),(0,u.CE)("div",_e,(0,c.toDisplayString)(e.$t("tickets.uploadingImages")||"\u56fe\u7247\u4e0a\u4f20\u4e2d..."),1)):(0,u.Q3)("",!0),lt.value.length?((0,u.uX)(),(0,u.CE)("div",$e,[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(lt.value,function(e){return(0,u.uX)(),(0,u.CE)("span",{key:e,class:"thumb",onClick:function(t){return function(e){var t="![image](".concat(e,")");(Et.value.message||"").includes(e)||dt(t)}(e)},title:"\u70b9\u51fb\u63d2\u5165\u5230\u5185\u5bb9",style:{display:"inline-block","margin-right":"8px",cursor:"pointer"}},[(0,u.Lk)("img",{src:e,style:{"max-width":"60px","max-height":"60px","border-radius":"6px",border:"1px solid #eee"}},null,8,Ie)],8,ze)}),128))])):(0,u.Q3)("",!0)])]),(0,u.Lk)("div",Fe,[(0,u.Lk)("button",{class:"btn-cancel",onClick:Gt},(0,c.toDisplayString)(e.$t("common.cancel")),1),(0,u.Lk)("button",{class:"btn-submit",onClick:Kt,disabled:Ye.value,type:"button"},[Ye.value?((0,u.uX)(),(0,u.CE)("span",Me)):(0,u.Q3)("",!0),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("common.submit")),1)],8,xe)])],2)],2)):(0,u.Q3)("",!0)])),tt.value?((0,u.uX)(),(0,u.CE)("div",{key:0,class:(0,c.normalizeClass)(["modal-overlay",{"show-overlay":Bt.value}]),onClick:Vt},[(0,u.Lk)("div",{class:(0,c.normalizeClass)(["modal-content",{"modal-close-animation":Pt.value}]),onClick:a[13]||(a[13]=(0,v.withModifiers)(function(){},["stop"]))},[(0,u.Lk)("div",We,[(0,u.Lk)("h3",null,(0,c.toDisplayString)(e.$t("tickets.closeConfirmTitle")),1),(0,u.Lk)("button",{class:"modal-close",onClick:a[11]||(a[11]=function(e){return tt.value=!1})},[(0,u.bF)((0,o.R1)(m.MRt),{size:20})])]),(0,u.Lk)("div",je,[(0,u.Lk)("p",null,(0,c.toDisplayString)(e.$t("tickets.closeConfirmText")),1)]),(0,u.Lk)("div",Qe,[(0,u.Lk)("button",{class:"btn-cancel",onClick:a[12]||(a[12]=function(e){return tt.value=!1})},(0,c.toDisplayString)(e.$t("common.cancel")),1),(0,u.Lk)("button",{class:"btn-submit",onClick:Ft,disabled:at.value},[at.value?((0,u.uX)(),(0,u.CE)("span",Ne)):(0,u.Q3)("",!0),(0,u.eW)(" "+(0,c.toDisplayString)(e.$t("common.confirm")),1)],8,He)])],2)],2)):(0,u.Q3)("",!0)],64)),(0,u.bF)(L.A,{"show-popup":ta.value,title:(0,o.R1)(aa).title,content:(0,o.R1)(aa).content,"cooldown-hours":(0,o.R1)(aa).cooldownHours,"close-wait-seconds":(0,o.R1)(aa).closeWaitSeconds,onClose:na},null,8,["show-popup","title","content","cooldown-hours","close-wait-seconds"])])}}};const Ge=(0,a(66262).A)(Be,[["__scopeId","data-v-85f17e4c"]])},90208(e,t,a){a.d(t,{A:()=>s});a(52675),a(89463),a(2259),a(16280),a(76918),a(26099),a(47764),a(62953);var n=a(54119);function s(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],a=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}}}throw new TypeError((0,n.A)(e)+" is not iterable")}}}]);