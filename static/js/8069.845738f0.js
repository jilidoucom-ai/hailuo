"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[8069],{12321(e,t,a){a.d(t,{A:()=>l});var n=a(20641),s=a(90033),r={key:0,class:"spinner-text"};const o={name:"LoadingSpinner",props:{text:{type:String,default:""},overlay:{type:Boolean,default:!1}}};const l=(0,a(66262).A)(o,[["render",function(e,t,a,o,l,i){return(0,n.uX)(),(0,n.CE)("div",{class:(0,s.normalizeClass)(["loading-spinner",{"loading-spinner-overlay":a.overlay}])},[t[0]||(t[0]=(0,n.Lk)("div",{class:"spinner"},[(0,n.Lk)("div",{class:"spinner-circle"})],-1)),a.text?((0,n.uX)(),(0,n.CE)("div",r,(0,s.toDisplayString)(a.text),1)):(0,n.Q3)("",!0)],2)}],["__scopeId","data-v-4d20d688"]])},98069(e,t,a){a.r(t),a.d(t,{default:()=>me});var n=a(59258),s=a(20908),r=a(30388),o=(a(16280),a(76918),a(28706),a(44114),a(34782),a(23288),a(9868),a(20641)),l=a(90033),i=a(50953),u=a(53751),c=a(46992),d=a(71029),p=a(12321),v=a(14860),k=a(54119),f=(a(26099),a(19043));function g(){return(0,f.A)({url:"/user/order/fetch",method:"get"}).then(function(e){if("object"===(0,k.A)(e))return e;throw new Error("Invalid response format")}).catch(function(e){throw e})}function y(e){return new Promise(function(t,a){e?(0,f.A)({url:"/user/order/cancel",method:"post",data:{trade_no:e}}).then(function(e){e&&"object"===(0,k.A)(e)?t(e):a(new Error("\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u4e0d\u6b63\u786e"))}).catch(function(e){var t="\u53d6\u6d88\u8ba2\u5355\u5931\u8d25";if(e)if("string"==typeof e.message)t=e.message;else if(e.response&&e.response.data){var n=e.response.data;"string"==typeof n?t=n:n.message?t=n.message:n.error&&(t=n.error)}a(new Error(t))}):a(new Error("\u8ba2\u5355\u53f7\u4e0d\u80fd\u4e3a\u7a7a"))})}var h=a(43258),m={class:"orders-container"},b={class:"orders-inner"},L={class:"dashboard-card welcome-card"},w={class:"card-header"},C={class:"card-title"},_={class:"card-body"},S={key:0,class:"orders-loading"},D={key:1,class:"orders-error"},A={key:2,class:"orders-content"},E={key:0,class:"pagination-container"},R={class:"pagination"},z=["disabled"],F={class:"page-info"},X=["disabled"],T={key:0,class:"swipe-hint"},K={class:"order-card-header"},x={class:"order-number"},Q={class:"label"},$={class:"value"},M={class:"status-wrapper"},N={class:"order-card-body"},I={class:"info-row"},W={class:"label"},O={class:"value"},j={class:"info-row"},q={class:"label"},G={class:"value"},H={class:"info-row"},B={class:"label"},V={class:"value amount"},P={class:"order-card-footer"},U=["onClick"],J=["onClick","disabled"],Y={class:"order-table"},Z={width:"22%"},ee={width:"16%"},te={width:"10%"},ae={width:"14%"},ne={width:"14%"},se={width:"24%"},re={class:"trade-no"},oe={class:"amount"},le={class:"actions"},ie=["onClick"],ue=["onClick","disabled"],ce={key:3,class:"orders-empty"},de={class:"modal-header"},pe={class:"modal-body"},ve={class:"trade-no-info"},ke={class:"trade-no"},fe={class:"modal-footer"},ge=["disabled"],ye={key:0,class:"loader"};const he={__name:"OrderList",setup:function(e){var t=(0,c.s9)(),a=t.t,k=t.locale,f=(0,d.rd)(),he=(0,o.WQ)("$toast"),me=(0,i.KR)(!0),be=(0,i.KR)(""),Le=(0,i.KR)([]),we=(0,i.KR)(!1),Ce=(0,i.KR)(""),_e=(0,i.KR)(!1),Se=(0,i.KR)(!1),De=(0,i.KR)("left"),Ae=(0,i.KR)("\xa5"),Ee=function(){Se.value=window.innerWidth<768};window.addEventListener("resize",Ee);var Re=(0,i.KR)(1),ze=(0,o.EW)(function(){return Math.ceil(Le.value.length/10)}),Fe=(0,o.EW)(function(){var e=10*(Re.value-1),t=e+10;return Le.value.slice(e,t)}),Xe=(0,i.KR)(0),Te=(0,i.KR)(0),Ke=function(e){Xe.value=e.touches[0].clientX},xe=function(e){Te.value=e.touches[0].clientX},Qe=function(){var e=Te.value-Xe.value;Math.abs(e)>50&&(e>0?(De.value="right",Me()):(De.value="left",$e())),Xe.value=0,Te.value=0},$e=function(){Re.value<ze.value&&(De.value="left",Re.value++)},Me=function(){Re.value>1&&(De.value="right",Re.value--)},Ne=function(){var e=(0,r.A)((0,s.A)().m(function e(){var t,n;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return me.value=!0,be.value="",e.p=1,e.n=2,g();case 2:(t=e.v)&&t.data?(Le.value=t.data,Re.value=1):Le.value=[],e.n=4;break;case 3:e.p=3,n=e.v,be.value=n&&n.message?n.message:a("common.networkError")||"\u7f51\u7edc\u9519\u8bef",he&&he.error(be.value);case 4:return e.p=4,me.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),Ie=function(e){return e?new Date(1e3*e).toLocaleString("zh-CN"===k.value?"zh-CN":"en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"--"},We=function(e){return e?{month_price:a("shop.plan.price_options.month")||"\u6708\u4ed8",quarter_price:a("shop.plan.price_options.quarter")||"\u5b63\u5ea6",half_year_price:a("shop.plan.price_options.half_year")||"\u534a\u5e74",year_price:a("shop.plan.price_options.year")||"\u4e00\u5e74",two_year_price:a("shop.plan.price_options.two_year")||"\u4e24\u5e74",three_year_price:a("shop.plan.price_options.three_year")||"\u4e09\u5e74",onetime_price:a("shop.plan.price_options.onetime")||"\u4e00\u6b21\u6027",reset_price:a("shop.plan.price_options.reset_price")||"\u91cd\u7f6e\u6d41\u91cf\u5305",deposit:a("shop.plan.price_options.deposit")||"\u5145\u503c"}[e]||e:"--"},Oe=function(e){return null==e?"--":Ae.value+(e/100).toFixed(2)},je=(0,o.EW)(function(){return{0:a("orders.status.pending","\u5f85\u652f\u4ed8"),1:a("orders.status.processing","\u5f00\u901a\u4e2d"),2:a("orders.status.cancelled","\u5df2\u53d6\u6d88"),3:a("orders.status.completed","\u5df2\u5b8c\u6210"),4:a("orders.status.discounted","\u5df2\u6298\u62b5"),unknown:a("orders.status.unknown","\u672a\u77e5\u72b6\u6001")}}),qe=function(e){return je.value[e]||"".concat(je.value.unknown," (").concat(e,")")},Ge=function(e){return{0:"status-pending",1:"status-processing",2:"status-cancelled",3:"status-completed",4:"status-discounted"}[e]||"status-unknown"},He=function(e){f.push({path:"/payment",query:{trade_no:e,from:"orders"}})},Be=function(e){Ce.value=e,we.value=!0},Ve=function(){we.value=!1},Pe=function(){var e=(0,r.A)((0,s.A)().m(function e(){var t,n;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(Ce.value&&!_e.value){e.n=1;break}return e.a(2);case 1:return _e.value=!0,e.p=2,e.n=3,y(Ce.value);case 3:he&&"function"==typeof he.success&&he.success(a("orders.cancelSuccess")||"\u8ba2\u5355\u5df2\u53d6\u6d88"),Ve(),Ne(),e.n=5;break;case 4:e.p=4,n=e.v,t=a("orders.cancelFailed")||"\u53d6\u6d88\u8ba2\u5355\u5931\u8d25";try{n&&("string"==typeof n?t=n:n instanceof Error?t=n.message||t:"string"==typeof n.message&&(t=n.message))}catch(e){}he&&"function"==typeof he.error?he.error(t):alert(t),Ve();case 5:return e.p=5,_e.value=!1,e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])}));return function(){return e.apply(this,arguments)}}(),Ue=(0,o.EW)(function(){return{tradeNo:a("orders.tradeNo","\u8ba2\u5355\u53f7"),createdAt:a("orders.createdAt","\u521b\u5efa\u65f6\u95f4"),cycle:a("orders.cycle","\u5468\u671f"),totalAmount:a("orders.totalAmount","\u91d1\u989d"),statusLabel:a("orders.statusLabel","\u72b6\u6001")||"\u72b6\u6001",actions:a("orders.actions","\u64cd\u4f5c"),viewDetail:a("orders.viewDetail","\u67e5\u770b\u8be6\u60c5"),cancel:a("orders.cancel","\u53d6\u6d88\u8ba2\u5355"),noOrders:a("orders.noOrders","\u6682\u65e0\u8ba2\u5355"),goShopping:a("orders.goShopping","\u53bb\u8d2d\u4e70\u5957\u9910"),loading:a("orders.loading","\u6b63\u5728\u52a0\u8f7d\u8ba2\u5355..."),cancelConfirmTitle:a("orders.cancelConfirmTitle","\u786e\u8ba4\u53d6\u6d88\u8ba2\u5355"),cancelConfirmText:a("orders.cancelConfirmText","\u60a8\u786e\u5b9a\u8981\u53d6\u6d88\u6b64\u8ba2\u5355\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u9500\u3002")}}),Je=function(){var e=(0,r.A)((0,s.A)().m(function e(){var t;return(0,s.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,h.l8)();case 1:(t=e.v)&&t.data&&t.data.currency_symbol&&(Ae.value=t.data.currency_symbol),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}));return function(){return e.apply(this,arguments)}}();return(0,o.sV)(function(){Je(),Ne(),Ee()}),(0,o.wB)(k,function(){Le.value.length>0&&(Le.value=(0,n.A)(Le.value))}),function(e,t){return(0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",b,[(0,o.Lk)("div",L,[(0,o.Lk)("div",w,[(0,o.Lk)("h2",C,(0,l.toDisplayString)(e.$t("orders.welcome.title")||"\u8ba2\u5355\u5217\u8868"),1)]),(0,o.Lk)("div",_,[(0,o.Lk)("p",null,(0,l.toDisplayString)(e.$t("orders.welcome.description")||"\u67e5\u770b\u5e76\u7ba1\u7406\u60a8\u7684\u8ba2\u5355"),1)])]),me.value?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.bF)(p.A),(0,o.Lk)("p",null,(0,l.toDisplayString)(Ue.value.loading),1)])):be.value?((0,o.uX)(),(0,o.CE)("div",D,[(0,o.bF)((0,i.R1)(v.QO),{size:48,class:"error-icon"}),(0,o.Lk)("p",null,(0,l.toDisplayString)(be.value),1),(0,o.Lk)("button",{class:"retry-button",onClick:Ne},(0,l.toDisplayString)(e.$t("common.retry")||"\u91cd\u8bd5"),1)])):Le.value.length>0?((0,o.uX)(),(0,o.CE)("div",A,[ze.value>1?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("div",R,[(0,o.Lk)("button",{class:(0,l.normalizeClass)(["page-button prev",{disabled:1===Re.value}]),onClick:Me,disabled:1===Re.value},[(0,o.bF)((0,i.R1)(v.gu7),{size:16})],10,z),(0,o.Lk)("div",F,(0,l.toDisplayString)(e.$t("common.page")||"\u9875")+" "+(0,l.toDisplayString)(Re.value)+" / "+(0,l.toDisplayString)(ze.value),1),(0,o.Lk)("button",{class:(0,l.normalizeClass)(["page-button next",{disabled:Re.value===ze.value}]),onClick:$e,disabled:Re.value===ze.value},[(0,o.bF)((0,i.R1)(v.Vjx),{size:16})],10,X)])])):(0,o.Q3)("",!0),Se.value?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"order-cards",onTouchstart:Ke,onTouchmove:xe,onTouchend:Qe},[Le.value.length>10?((0,o.uX)(),(0,o.CE)("div",T,[(0,o.bF)((0,i.R1)(v.Gk),{size:16,class:"swipe-icon"}),(0,o.Lk)("span",null,(0,l.toDisplayString)(e.$t("common.swipeHint")||"\u5de6\u53f3\u6ed1\u52a8\u5207\u6362"),1),(0,o.bF)((0,i.R1)(v.hIg),{size:16,class:"swipe-icon"})])):(0,o.Q3)("",!0),(0,o.bF)(u.TransitionGroup,{name:"right"===De.value?"page-switch-right":"page-switch"},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Fe.value,function(e){return(0,o.uX)(),(0,o.CE)("div",{key:e.trade_no,class:"order-card"},[(0,o.Lk)("div",K,[(0,o.Lk)("div",x,[(0,o.Lk)("span",Q,(0,l.toDisplayString)(Ue.value.tradeNo)+":",1),(0,o.Lk)("span",$,(0,l.toDisplayString)(e.trade_no),1)]),(0,o.Lk)("div",M,[(0,o.Lk)("span",{class:(0,l.normalizeClass)(["status-badge",Ge(e.status)])},(0,l.toDisplayString)(qe(e.status)),3)])]),(0,o.Lk)("div",N,[(0,o.Lk)("div",I,[(0,o.Lk)("span",W,(0,l.toDisplayString)(Ue.value.createdAt)+":",1),(0,o.Lk)("span",O,(0,l.toDisplayString)(Ie(e.created_at)),1)]),(0,o.Lk)("div",j,[(0,o.Lk)("span",q,(0,l.toDisplayString)(Ue.value.cycle)+":",1),(0,o.Lk)("span",G,(0,l.toDisplayString)(We(e.period)),1)]),(0,o.Lk)("div",H,[(0,o.Lk)("span",B,(0,l.toDisplayString)(Ue.value.totalAmount)+":",1),(0,o.Lk)("span",V,(0,l.toDisplayString)(Oe(e.total_amount)),1)])]),(0,o.Lk)("div",P,[(0,o.Lk)("button",{class:"action-button view-button",onClick:function(t){return He(e.trade_no)}},[(0,o.bF)((0,i.R1)(v.HvQ),{size:16}),(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.viewDetail),1)],8,U),(0,o.Lk)("button",{class:(0,l.normalizeClass)(["action-button cancel-button",{disabled:0!==e.status}]),onClick:function(t){return Be(e.trade_no)},disabled:0!==e.status},[(0,o.bF)((0,i.R1)(v.MRt),{size:16}),(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.cancel),1)],10,J)])])}),128))]}),_:1},8,["name"])],32)):((0,o.uX)(),(0,o.CE)("div",{key:2,class:"order-table-container",onTouchstart:Ke,onTouchmove:xe,onTouchend:Qe},[(0,o.Lk)("table",Y,[(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",Z,(0,l.toDisplayString)(Ue.value.tradeNo),1),(0,o.Lk)("th",ee,(0,l.toDisplayString)(Ue.value.createdAt),1),(0,o.Lk)("th",te,(0,l.toDisplayString)(Ue.value.cycle),1),(0,o.Lk)("th",ae,(0,l.toDisplayString)(Ue.value.totalAmount),1),(0,o.Lk)("th",ne,(0,l.toDisplayString)(Ue.value.statusLabel),1),(0,o.Lk)("th",se,(0,l.toDisplayString)(Ue.value.actions),1)])]),(0,o.Lk)("tbody",null,[(0,o.bF)(u.TransitionGroup,{name:"right"===De.value?"page-switch-right":"page-switch"},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(Fe.value,function(e){return(0,o.uX)(),(0,o.CE)("tr",{key:e.trade_no},[(0,o.Lk)("td",re,(0,l.toDisplayString)(e.trade_no),1),(0,o.Lk)("td",null,(0,l.toDisplayString)(Ie(e.created_at)),1),(0,o.Lk)("td",null,(0,l.toDisplayString)(We(e.period)),1),(0,o.Lk)("td",oe,(0,l.toDisplayString)(Oe(e.total_amount)),1),(0,o.Lk)("td",null,[(0,o.Lk)("span",{class:(0,l.normalizeClass)(["status-badge",Ge(e.status)])},(0,l.toDisplayString)(qe(e.status)),3)]),(0,o.Lk)("td",le,[(0,o.Lk)("button",{class:"action-button view-button",onClick:function(t){return He(e.trade_no)}},[(0,o.bF)((0,i.R1)(v.HvQ),{size:16}),(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.viewDetail),1)],8,ie),(0,o.Lk)("button",{class:(0,l.normalizeClass)(["action-button cancel-button",{disabled:0!==e.status}]),onClick:function(t){return Be(e.trade_no)},disabled:0!==e.status},[(0,o.bF)((0,i.R1)(v.MRt),{size:16}),(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.cancel),1)],10,ue)])])}),128))]}),_:1},8,["name"])])])],32))])):((0,o.uX)(),(0,o.CE)("div",ce,[(0,o.bF)((0,i.R1)(v.AMT),{size:48,class:"empty-icon"}),(0,o.Lk)("p",null,(0,l.toDisplayString)(Ue.value.noOrders),1),(0,o.Lk)("button",{class:"shop-button",onClick:t[0]||(t[0]=function(t){return e.$router.push("/shop")})},[(0,o.bF)((0,i.R1)(v.AMT),{size:16}),(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.goShopping),1)])])),(0,o.bF)(u.Transition,{name:"modal-fade"},{default:(0,o.k6)(function(){return[we.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:Ve},[(0,o.Lk)("div",{class:"modal-content",onClick:t[1]||(t[1]=(0,u.withModifiers)(function(){},["stop"]))},[(0,o.Lk)("div",de,[(0,o.Lk)("h3",null,(0,l.toDisplayString)(Ue.value.cancelConfirmTitle),1),(0,o.Lk)("button",{class:"modal-close",onClick:Ve},[(0,o.bF)((0,i.R1)(v.MRt),{size:20})])]),(0,o.Lk)("div",pe,[(0,o.Lk)("p",null,(0,l.toDisplayString)(Ue.value.cancelConfirmText),1),(0,o.Lk)("div",ve,[(0,o.Lk)("span",null,(0,l.toDisplayString)(Ue.value.tradeNo)+":",1),(0,o.Lk)("span",ke,(0,l.toDisplayString)(Ce.value),1)])]),(0,o.Lk)("div",fe,[(0,o.Lk)("button",{class:"btn-cancel",onClick:Ve},(0,l.toDisplayString)(e.$t("common.cancel")||"\u53d6\u6d88"),1),(0,o.Lk)("button",{class:"btn-confirm",onClick:Pe,disabled:_e.value},[_e.value?((0,o.uX)(),(0,o.CE)("span",ye)):(0,o.Q3)("",!0),(0,o.Lk)("span",null,(0,l.toDisplayString)(e.$t("common.confirm")||"\u786e\u8ba4"),1)],8,ge)])])])):(0,o.Q3)("",!0)]}),_:1})])])}}};const me=(0,a(66262).A)(he,[["__scopeId","data-v-362fe809"]])}}]);